webpackJsonp([1],{127:function(t,e,i){"use strict";var a=i(89),n=i(460),o=i(450),r=i.n(o),s=i(452),c=i.n(s),l=i(451),d=i.n(l),u=i(453),p=i.n(u);a.a.use(n.a);var f=new n.a({routes:[{path:"/customer-poi",name:"customer-poi",component:r.a,children:[{path:"finish",component:c.a,name:"customer-finish"},{path:"abnormal",component:d.a,name:"customer-abnormal"},{path:"map",component:p.a,name:"customer-map"}]}]});e.a=f},180:function(t,e,i){"use strict";var a=i(89),n=i(64),o=i(188);a.a.use(n.b),e.a=new n.b.Store({state:{loading:"close",loadingTitle:"正在获取您的位置...",loadingAside:"请开启获取位置信息权限"},mutations:{changeLoading:function(t,e){t.loading=e.state,t.loadingTitle=e.title||"正在获取您的位置...",t.loadingAside=e.aside||"请开启获取位置信息权限"}},actions:{changeLoading:function(t,e){(0,t.commit)("changeLoading",e)}},modules:{customer:o.a}})},181:function(t,e,i){"use strict";function a(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"0";if(t+="",t.length<e){for(var a=[],n=0,o=e-t.length;n<o;n++)a.push(i);t=a.join("")+t}return t}function n(t){var e=new Date(1e3*t);return[e.getFullYear(),a(e.getMonth()+1),a(e.getDate())].join("-")+" "+[a(e.getHours()),a(e.getMinutes()),a(e.getSeconds())].join(":")}e.a={leftPad:a,timeformat:n},window.requestAnimationFrame||(window.requestAnimationFrame=function(t){return setTimeout(t,0)})},183:function(t,e,i){function a(t){i(442)}var n=i(57)(i(190),i(457),a,null,null);t.exports=n.exports},185:function(t,e,i){"use strict";function a(t){return r.a.race([function(){return new r.a(function(e,i){var a=document.createElement("script");a.type="text/javascript",a.async="async",a.onload=a.onreadystatechange=function(){this.readyState&&!/^(loaded|complete)$/.test(this.readyState)||(e(),a.onload=a.onreadystatechange=null)},a.onerror=function(){i(new Error("load "+t+" error")),a.onerror=null},a.src=t,document.getElementsByTagName("head")[0].appendChild(a)})}(),function(){return new r.a(function(e,i){setTimeout(function(){i(new Error("load "+t+" timeout"))},5e3)})}()])}e.a=a;var n=i(201),o=(i.n(n),i(198)),r=i.n(o)},186:function(t,e,i){"use strict";function a(t){r=[t],i.i(n.a)(o).then(function(){r.forEach(function(t){t&&t(window.DDMap)})})}var n=i(185),o="//webapp.didistatic.com/static/webapp/map/z/map-webapp-jssdk/1.2.24/DDMap.qq.min.js",r=[];e.a=a},187:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i(182),n=(i.n(a),i(89)),o=i(183),r=i.n(o),s=i(127),c=i(180),l=i(181),d={methods:{setTitle:function(){this.title&&l.a.setTitle(this.title)}}};n.a.mixin(d),n.a.config.productionTip=!1,new n.a({el:"#app",router:s.a,store:c.a,template:"<App/>",components:{App:r.a}})},188:function(t,e,i){"use strict";function a(t,e){8===t.detail.surveyStatus?(e("changeLoading",{state:"close"},{root:!0}),n.a.replace("/customer-poi/finish?surveyOrderId="+t.detail.surveyOrderId)):9===t.detail.surveyStatus&&(e("changeLoading",{state:"close"},{root:!0}),n.a.replace("/customer-poi/abnormal?surveyOrderId="+t.detail.surveyOrderId))}var n=i(127),o=i(189);e.a={namespaced:!0,state:{detail:{accidentSheetInfo:{}},isPoi:!1,isDetail:!1,isUpload:!1,mapUser:null},mutations:{setDetail:function(t,e){e.surveyStatus=5,e.isSubmit=!!e.accidentSheetInfo.serviceAttitudeScore&&!!e.accidentSheetInfo.majorSkillScore,t.detail=e,t.isDetail=!0},setMapUser:function(t,e){t.isPoi=!0,t.mapUser=e}},actions:{addEvaluation:function(t,e){var i=t.dispatch,a=t.state;o.a.post("/order/addEvaluation",e).then(function(t){t.data;i("getOrderDetail",{surveyOrderId:a.detail.surveyOrderId})})},setPoi:function(t,e){var i=t.commit,n=t.state;o.a.post("/uploadLoc",{surveyOrderId:n.detail.surveyOrderId,location:e}).then(function(t){t.data;i("changeLoading",{state:"close"},{root:!0}),a(n,i)},function(t){i("changeLoading",{state:"close"},{root:!0}),a(n,i),n.isUpload=!0})},uploadPoi:function(t){var e=t.dispatch,i=t.commit,n=t.state;if(n.isPoi&&n.isDetail){if(n.isUpload)return a(n,i);if(n.isUpload=!0,n.detail.changedAccidentTime)e("setPoi",[n.mapUser.getPosition()]);else{i("changeLoading",{state:"waiting",title:"报案成功！正在校正您的位置，请勿离开页面",aside:"约耗时5秒，定位精准能够更快获得支援"},{root:!0});var o=[],r=setInterval(function(){o.push(n.mapUser.getPosition()),o.length>=3&&(e("setPoi",o),clearInterval(r))},1e3)}}},setMapUser:function(t,e){var i=(t.state,t.commit),a=t.dispatch;i("setMapUser",e),a("uploadPoi")},getOrderDetail:function(t){var e=(t.state,t.commit),i=t.dispatch,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o.a.post("/order/getOrderDetail",{surveyOrderId:a.surveyOrderId,picKey:"sheet_0"}).then(function(t){var n=t.data;e("setDetail",n),i("uploadPoi"),a.cb&&a.cb(n)},function(t){e("changeLoading",{state:"reload",title:"页面出现错误，点击屏幕重试",aside:t.msg},{root:!0})})}}}},189:function(t,e,i){"use strict";function a(t){if(t.status>=200&&t.status<300)return t;var e=new Error(t.statusText);throw e.response=t,e}function n(t){return t.json()}function o(t,e){return fetch(t,{method:"POST",mode:"cors",headers:{"Content-Type":"text/plain"},body:l()(e)}).then(a).then(n)}function r(t,e){return o(p+t,e).then(function(t){if(0!==t.errNo){var e=new Error(t.errNo);throw e.data=t.data,e.msg=t.errMsg,e.errNo=t.errNo,e}return t}).catch(function(t){throw t})}function s(t){return fetch(t).then(a).then(n)}var c=i(196),l=i.n(c),d=i(462),u=(i.n(d),i(184)),p=(i.n(u),"http://10.95.97.35:8002/v1");e.a={post:r,get:s}},190:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i(65),n=i.n(a),o=i(64);e.default={computed:n()({},i.i(o.a)({loading:"loading",loadingTitle:"loadingTitle",loadingAside:"loadingAside"})),methods:{loadingClickHandle:function(){"reload"===this.loading&&location.reload()}}}},191:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a={10:"非常不",20:"不",30:"",40:"很",50:"非常"};e.default={data:function(){return{textMap:a}},props:{label:{type:String},value:{type:String},disabled:{type:Boolean,default:!1}},methods:{clickHandle:function(t){this.disabled||this.$emit("input",""+t)}}}},192:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i(65),n=i.n(a),o=i(64),r=[{title:"用户信息加载中",aside:"更多信息稍后更新"},{title:"正在为您紧急联络最近的查勘员",aside:"更多信息稍后更新"},{title:"已为您安排查勘员前往",aside:"查勘员将抵达事故现场为您拍照取证"},{title:"查勘员已出发",aside:"查勘员将抵达事故现场为您拍照取证"},{title:"查勘员抵达现场，即将开始查勘",aside:"将拍摄现场及证件照片，并填写现场确认单",needTip:!0},{title:"查勘已结束",aside:"后续定责理赔情况，请联系案件负责人"},{title:"您的报案已经安排相应人员进行处理",aside:"更多信息请联系案件负责人进行咨询"}],s=[0,1,1,2,2,3,4,4,5,6];e.default={computed:n()({},i.i(o.a)("customer",{detail:"detail",topInfo:function(t){return r[s[t.detail.surveyStatus||0]]}})),mounted:function(){this.$store.dispatch("customer/getOrderDetail",{surveyOrderId:this.$route.query.surveyOrderId})}}},193:function(t,e){},194:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i(65),n=i.n(a),o=i(64),r=i(449),s=i.n(r);e.default={components:{ScoreField:s.a},computed:n()({},i.i(o.a)("customer",{detail:"detail",accidentSheetInfo:function(t){return t.detail.accidentSheetInfo}})),methods:{handleSubmit:function(){var t=this.accidentSheetInfo,e=t.serviceAttitudeScore,i=t.majorSkillScore;+e&&+i&&this.$store.dispatch("customer/addEvaluation",{surveyOrderId:this.detail.surveyOrderId,serviceAttitudeScore:e,majorSkillScore:i,driverId:this.detail.driverId})}}}},195:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i(65),n=i.n(a),o=i(186),r=i(64);e.default={data:function(){return{list:[],pollingFn:null,isReady:!1,mapUploadIndex:0}},computed:n()({},i.i(r.a)("customer",{detail:"detail"})),methods:{uploadMap:function(t){var e=t.driverInfo,i=e.driverLat,a=e.driverLng;a&&i&&this.isReady&&(this.driver?this.driver.setPosition({lat:i,lng:a}):this.driver=new this.DDMap.component.User({map:this.map,type:1,geo:!1,lat:i,lng:a}),(++this.mapUploadIndex%2==1||this.mapUploadIndex<3)&&this.map.setView([this.user,this.driver],{center:this.user.getPosition(),paddingTop:45,paddingBottom:45,paddingLeft:5,paddingRight:5}))},polling:function(){var t=this;this.pollingFn=setTimeout(function(){t.$store.dispatch("customer/getOrderDetail",{surveyOrderId:t.$route.query.orderId,cb:t.uploadMap}),t.polling()},5e6)}},created:function(){var t=this;this.$store.dispatch("changeLoading",{state:"show"}),i.i(o.a)(function(e){t.DDMap=e,e.ready(function(i){t.isReady=!0,t.map=i.createMap("map-area",{lat:40.043706847995594,lng:116.29026705374616}),t.user=new e.component.User({map:t.map,type:0,geo:!0,rate:500,callback:function(e,i){if(e)t.$store.dispatch("changeLoading",{state:"reload",title:"无法获取您的位置，点击屏幕重试",aside:"请开启获取位置信息权限"});else{var a=i.getPosition();t.map.setCenter(a.lat,a.lng),t.$store.dispatch("customer/setMapUser",i),t.uploadMap(t.detail)}}})})})},mounted:function(){this.pollingFn||this.polling()},beforeDestroy:function(){clearTimeout(this.pollingFn)}}},439:function(t,e){},440:function(t,e){},441:function(t,e){},442:function(t,e){},443:function(t,e){},444:function(t,e){},449:function(t,e,i){function a(t){i(440)}var n=i(57)(i(191),i(455),a,"data-v-4975546e",null);t.exports=n.exports},450:function(t,e,i){function a(t){i(443)}var n=i(57)(i(192),i(458),a,null,null);t.exports=n.exports},451:function(t,e,i){function a(t){i(444)}var n=i(57)(i(193),i(459),a,null,null);t.exports=n.exports},452:function(t,e,i){function a(t){i(439)}var n=i(57)(i(194),i(454),a,null,null);t.exports=n.exports},453:function(t,e,i){function a(t){i(441)}var n=i(57)(i(195),i(456),a,null,null);t.exports=n.exports},454:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"finish-page"},[t._m(0),t._v(" "),t._m(1),t._v(" "),i("score-field",{attrs:{label:"服务态度",disabled:!!t.detail.isSubmit},model:{value:t.accidentSheetInfo.serviceAttitudeScore,callback:function(e){t.$set(t.accidentSheetInfo,"serviceAttitudeScore",e)},expression:"accidentSheetInfo.serviceAttitudeScore"}}),t._v(" "),i("score-field",{attrs:{label:"专业水平",disabled:!!t.detail.isSubmit},model:{value:t.accidentSheetInfo.majorSkillScore,callback:function(e){t.$set(t.accidentSheetInfo,"majorSkillScore",e)},expression:"accidentSheetInfo.majorSkillScore"}}),t._v(" "),t.detail.isSubmit?t._e():i("div",{class:{btn:!0,disabled:!+this.accidentSheetInfo.serviceAttitudeScore||!+this.accidentSheetInfo.majorSkillScore},on:{click:t.handleSubmit}},[t._v("提交评论")]),t._v(" "),t._m(2),t._v(" "),i("div",{staticClass:"finish-img"},[i("img",{attrs:{src:t.detail.url}})])],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"map-box map-top"},[i("div",{staticClass:"title"},[t._v("查勘已结束")]),t._v(" "),i("aside",[t._v("后续定责理赔情况，请联系案件负责人")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"customer-info rel ovh"},[i("div",{staticClass:"title rel"},[t._v("查勘员服务评价")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"customer-info rel ovh"},[i("div",{staticClass:"title rel"},[t._v("事故确认单")])])}]}},455:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"field clearfix"},[i("label",[t._v(t._s(t.label)+":")]),t._v(" "),i("div",{staticClass:"box"},t._l(5,function(e){return i("div",{class:{item:!0,active:t.value>=10*e},on:{click:function(i){t.clickHandle(10*e)}}})}))])},staticRenderFns:[]}},456:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},staticRenderFns:[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"page layout ovh"},[i("div",{staticClass:"map-area abs",attrs:{id:"map-area"}})])}]}},457:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"layout"},[i("router-view"),t._v(" "),i("div",{class:(a={"loading-layout":!0},a[t.loading]=!0,a),on:{click:t.loadingClickHandle}},[i("div",{staticClass:"loading-box"},[i("div",{staticClass:"title"},[t._v(t._s(t.loadingTitle))]),t._v(" "),i("aside",[t._v(t._s(t.loadingAside))])])])],1);var a},staticRenderFns:[]}},458:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:"layout ovh rel "+(this.$route.name||"")},[i("div",{staticClass:"page layout scroll customer-page"},[i("router-view")],1),t._v(" "),i("div",{staticClass:"map-box map-top"},[i("div",{staticClass:"title"},[t._v(t._s(t.topInfo.title))]),t._v(" "),i("aside",[t._v(t._s(t.topInfo.aside))])]),t._v(" "),i("div",{class:{"map-box":!0,"map-bottom":!0,active:t.detail.auditPhone&&t.detail.reportNo}},[i("div",{staticClass:"map-call"},[i("a",{attrs:{href:"tel:"+t.detail.auditPhone}},[i("i")])]),t._v(" "),i("div",[t._v("报案号："+t._s(t.detail.reportNo))]),t._v(" "),i("div",[t._v("案件负责人电话："+t._s(t.detail.auditPhone))])])])},staticRenderFns:[]}},459:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},staticRenderFns:[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"abnoraml-page"},[i("div",{staticClass:"abnormal-box"}),t._v(" "),i("div",{staticClass:"customer-info rel ovh"},[i("div",{staticClass:"title rel"},[t._v("温馨小贴士")]),t._v(" "),i("aside",[t._v("请迅速转移至安全地带，并在车后150米外树立警示牌。")])])])}]}}},[187]);